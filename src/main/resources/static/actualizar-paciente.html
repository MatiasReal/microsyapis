<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Clínica Odontológica - Actualizar paciente</title>
</head>
<body>
  <main>
    <h1>Actualizar paciente</h1>
    <form id="pacienteForm">
      <div>
        <label for="id-paciente">Identificador</label>
        <input type="text" id="id-paciente" name="id-paciente">
      </div>
      <div>
        <label for="nombre-paciente">Nombre</label>
        <input type="text" id="nombre-paciente" name="nombre-paciente">
      </div>
      <div>
        <label for="apellido-paciente">Apellido</label>
        <input type="text" id="apellido-paciente" name="apellido-paciente">
      </div>
      <div>
        <label for="telefono-paciente">Telefono</label>
        <input type="number" id="telefono-paciente" name="telefono-paciente">
      </div>
      <div>
        <label for="correo-paciente">Correo</label>
        <input type="email" id="correo-paciente" name="correo-paciente">
      </div>
      <div>
        <label for="cedula-paciente">Cedula</label>
        <input type="number" id="cedula-paciente" name="cedula-paciente">
      </div>
      <button type="button" onclick="handleEliminarPaciente()">Eliminar</button>
      <button type="submit">Actualizar</button>
    </form>
  </main>
  <script>
    const pacienteForm = document.getElementById('pacienteForm');
    pacienteForm.addEventListener('submit', handleActualizarPaciente);

    async function handleEliminarPaciente() {
      const confirmAction = window.confirm("Estás seguro de que quiere eliminar al paciente?");
      if(confirmAction){
        const idPaciente = document.getElementById("id-paciente").value;
        const status = await fetch(`/pacientes/${idPaciente}`, {
          method: "DELETE",
        })
        if (status.status !== 200){
          window.alert("El paciente no fue eliminado");
        } else {
          window.alert("Paciente eliminado con exito!");
          location.replace("/");
        }
      }
    }

    async function handleActualizarPaciente(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      await fetch(`/pacientes/${e.target["id-paciente"].value}`, {
        method: "PUT",
        body: formData,
      })
    }
  </script>
</body>
</html>